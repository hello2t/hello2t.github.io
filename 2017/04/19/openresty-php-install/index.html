<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hello2t</title>

  
  <meta name="author" content="hello2t">
  

  
  <meta name="description" content="OpenResty 编译安装12345./configure --prefix=/data/openrestyyum install pcre-develyum install openssl-develmakemake install

service 启动脚本修改环境相关的配置

PHP 编译安">
  

  
  
  <meta name="keywords" content="">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="Hello2t"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hello2t" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Hello2t</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span></span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2017/04/19/openresty-php-install/" rel="bookmark">
        <time class="entry-date published" datetime="2017-04-19T14:50:10.391Z">
          2017-04-19
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h3 id="OpenResty-编译安装"><a href="#OpenResty-编译安装" class="headerlink" title="OpenResty 编译安装"></a>OpenResty 编译安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">./configure --prefix=/data/openresty</div><div class="line">yum install pcre-devel</div><div class="line">yum install openssl-devel</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure>
<ul>
<li><a href="https://www.nginx.com/resources/wiki/start/topics/examples/redhatnginxinit/" target="_blank" rel="external">service 启动脚本</a><br>修改环境相关的配置</li>
</ul>
<h3 id="PHP-编译安装"><a href="#PHP-编译安装" class="headerlink" title="PHP 编译安装"></a>PHP 编译安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">yum install -y autoconf</div><div class="line">yum install openssl-devel bison libxml2-devel libcurl-devel</div><div class="line">./buildconf --force</div><div class="line"></div><div class="line">./configure  --prefix=/data/php  --disable-debug --with-config-file-scan-dir=/data/php/etc/conf.d --with-config-file-path=/data/php/etc --with-fpm-user=www --with-fpm-group=www --enable-fpm --enable-opcache  --enable-session --enable-mbstring --enable-sockets --with-curl --with-openssl --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd</div><div class="line"></div><div class="line">cp php.ini-production /data/php/etc/php.ini</div><div class="line">cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</div><div class="line">cp /data/php/etc/php-fpm.conf.default /data/php/etc/php-fpm.conf</div><div class="line">cp /data/php/etc/php-fpm.d/www.conf.default /data/php/etc/php-fpm.d/www.conf</div><div class="line">groupadd www</div><div class="line">useradd -g www www</div></pre></td></tr></table></figure>
<h4 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h4><ul>
<li>configure: WARNING: You will need re2c 0.13.4 or later if you want to regenerate PHP parsers.<br><code>yum install re2c</code></li>
<li>configure: error: bison is required to build PHP/Zend when building a GIT checkout!<br><code>yum install bison</code></li>
<li>configure: error: xml2-config not found. Please check your libxml2 installation.<br><code>yum install libxml2-devel</code></li>
<li>configure: error: Cannot find OpenSSL’s <evp.h><br><code>yum install openssl-devel</code></evp.h></li>
<li>configure: error: Please reinstall the libcurl easy.h should be in <curl-dir>/include/curl/<br><code>yum install libcurl-devel</code></curl-dir></li>
<li>configure: error: mcrypt.h not found. Please reinstall libmcrypt.<br>注意第三方源才有<br><code>yum install libmcrypt libmcrypt-devel</code></li>
</ul>
<h3 id="OpCache-扩展配置"><a href="#OpCache-扩展配置" class="headerlink" title="OpCache 扩展配置"></a>OpCache 扩展配置</h3><ul>
<li>opcache.ini<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">zend_extension=opcache.so</div><div class="line">opcache.enable=1</div><div class="line">opcache.enable_cli=1</div><div class="line">#opcache.huge_code_pages=1</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="PHPRedis-扩展安装"><a href="#PHPRedis-扩展安装" class="headerlink" title="PHPRedis 扩展安装"></a>PHPRedis 扩展安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/data/php/bin/phpize</div><div class="line">./configure --with-php-config=/data/php/bin/php-config</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure>
<ul>
<li>redis.ini<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">extension=redis.so</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="XDebug-扩展安装"><a href="#XDebug-扩展安装" class="headerlink" title="XDebug 扩展安装"></a>XDebug 扩展安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/data/php/bin/phpize</div><div class="line">./configure --enable-xdebug--with-php-config=/data/php/bin/php-config</div><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure>
<ul>
<li>xdebug.ini<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">[xdebug]</div><div class="line">zend_extension=&quot;xdebug.so&quot;</div><div class="line">xdebug.trace_output_dir=&quot;/tmp&quot;</div><div class="line">xdebug.trace_output_name=trace.%H.%t</div><div class="line">; 记录添加到文件中方式：1 = 追加(如果存在该文件). 0 (default) = 覆盖（如果存在该文件）</div><div class="line">xdebug.trace_options=0</div><div class="line">; trace 数据格式</div><div class="line">; 0   shows a human readable indented trace file</div><div class="line">; 1   writes a computer readable format which has two different records</div><div class="line">; 2   writes a trace formatted in (simple) HTML</div><div class="line">xdebug.trace_format=0</div><div class="line">; 显示数据</div><div class="line">; 0 = 不显示.</div><div class="line">; 1 = 参数类型，值  (例如：array(9)).</div><div class="line">; 2 = 同上1，只是在CLI模式下略微有区别</div><div class="line">; 3 = 所有变量内容（受到 xdebug.var_display_max_children,xdebug.var_display_max_data 和xdebug.var_display_max_depth限制）</div><div class="line">; 4 = 所有变量内容和变量名(例如：array(0 =&gt; 9)).</div><div class="line">xdebug.collect_params=0</div><div class="line">; 是否收集函数返回值</div><div class="line">xdebug.collect_return=0</div><div class="line">; 关闭自动追踪，使用 XDEBUG_TRACE GET/POST 触发追踪, 或者通过设置cookie XDEBUG_TRACE</div><div class="line">xdebug.auto_trace=0</div><div class="line">xdebug.trace_enable_trigger=1</div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2017 hello2t
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>